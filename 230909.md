## âœ… Today I Did

### CMU Database Systems

#### 9ê°• Multi-Threaded Index Concurrency Control

- Latches vs. Locks
- Hash Table Latching
  - ëª¨ë“  ìŠ¤ë ˆë“œê°€ ê°™ì€ ë°©í–¥ìœ¼ë¡œ ì›€ì§ì´ë¯€ë¡œ ì‰¬ì›€ (ë°ë“œë½ X)
  - resizeì‹œ ì „ì²´ í…Œì´ë¸”ì— ëŒ€í•œ global latch
  - page latches vs. slot latches
- B+Tree Concurrency Control
  - Latch Crabbing/Coupling : ìì‹ ë…¸ë“œê°€ safe stateì¸ì§€ í™•ì¸í•˜ê¸° ì „ê¹Œì§€ ë¶€ëª¨ ë…¸ë“œì˜ latchë¥¼ ë†“ì§€ ì•ŠìŒ.
  - better latching algorithm(optimistic) : ë£¨íŠ¸ ë…¸ë“œë¶€í„° write latchë¥¼ ì¡ì§€ ì•Šê³ , internal nodeëŠ” read latchë§Œ ì¡ì€ í›„ merge, split ì‹œì—ë§Œ ê¸°ì¡´ ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•´ write latchë¥¼ ì¡ëŠ”ë‹¤.
  - leaf node scans : í•­ìƒ ê°™ì€ ë°©í–¥ìœ¼ë¡œ latch ì¡ëŠ” ê²ƒì´ ë³´ì¥ë˜ì§€ ì•ŠìŒ. latchëŠ” deadlock detection, avoidance ì•ˆ ë˜ë¯€ë¡œ ë°”ë¡œ latch ì¡ì§€ ëª»í•˜ëŠ” ê²½ìš° kill í›„ ë‹¤ì‹œ ì‹¤í–‰
  - delayed parent updates : split ì‹œ parentë¥¼ ë°”ë¡œ updateí•˜ì§€ ì•Šê³ , (globalë¡œ ì„ì‹œë¡œ ì €ì¥í•´ë†“ê³ ) ë‹¤ë¥¸ treadê°€ write latchë¥¼ ì¡ì•˜ì„ ë•Œ ì¶”ê°€í•  ìˆ˜ ìˆë„ë¡ í•¨ 

#### 10ê°• Sorting & Aggregations

Disk Manager -> Buffer Pool Manager -> Access Methods -> Operator Execution

- Sorting
  - ì™œ?
    - duplicate elimination (DISTINCT)
    - bulk loading into B+Tree
    - aggregations (GROUP BY)
  - íŠ¹ë³„í•œ ì•Œê³ ë¦¬ì¦˜ ì“°ëŠ” ì´ìœ 
    - disk-oriented DBMSì´ê¸° ë•Œë¬¸ì— ê¸°ì¡´ ì•Œê³ ë¦¬ì¦˜ì„ ì“°ë©´ ë¹„íš¨ìœ¨ì 
  - external merge sort
    - N pages, B buffer pages
    - Pass 0. B pageì”© í˜ì´ì§€ ë‚´ë¶€ ì •ë ¬
    - Pass 1~ 2page (input), 1 page (output) merge sort
    - double buffering optimzation (ë¯¸ë¦¬ ë‹¤ìŒ í˜ì´ì§€ë“¤ ì €ì¥í•´ë†“ê³ , í•œ í˜ì´ì§€ ë‹¤ ë³´ë©´ ë°”ë¡œ ë©”ëª¨ë¦¬ ë‚´ ë‹¤ë¥¸ ë²„í¼ì—ì„œ ì´ì–´ì„œ)
  - clustered index ì´ìš©	
- Aggregations
  - Implementation: Sorting or Hashing
  - external hashing aggregate
    - Phase 1. Partition
      - first hash function
      - B buffers -> B-1 buffers for the partition, 1 buffer for input data
    - Phase 2. ReHash
      - second hash function
      - assumption : each partition fits in memory

#### 11ê°• Join Algorithms

- join algorithms
  - two tables with inner equijoin
  - smaller table to be the left table (outer table) 
- decisions
  - output
    - data : outer, inner tupleì˜ attributeë“¤ì„ ë³µì‚¬ (attribute ë§ì€ ê²½ìš° ë¹„íš¨ìœ¨)
    - record ids : column storageì¸ ê²½ìš° ì£¼ë¡œ ì‚¬ìš©, late materialization
  - cost analysis criteria
    - # of IOs
    - table R and table S (M pages, m tuples in R, N pages, n tuples in S)
- Nested Loop Join
  - Stupid Nested Loop Join : ì´ì¤‘ forë¬¸ (tupleë§ˆë‹¤) M  + m * N
  - Block Nested Loop join : M + M * N
    - Rì„ ìœ„í•´ B-2 bufferë¥¼ ì“¸ ìˆ˜ ìˆë‹¤ë©´ M + ceil(M / (B-2)) * N
  - Index Nested Loop Join : Sì— ëŒ€í•œ indexë¡œ ì°¾ëŠ” costê°€ Cì¸ ê²½ìš° M + m * C
- Sort-Merge Join
  - Phase 1. Sort both tables
  - Phase 2. Merge : í‰ê·  M + N, ìµœì•… M * N
  - ì–¸ì œ ì‚¬ìš©?
    - input already sorted
    - outputì„ sortí•  ê²½ìš° (ORDER BY)
- Hash Join
  - Phase 1. Rì— ëŒ€í•œ hash table ë§Œë“¤ê¸°
  - Phase 2. Sì˜ íŠœí”Œì— ëŒ€í•´ hash ê°’ ê²Œì‚° í›„ join


## â° ë£¨í‹´ ë§Œë“¤ê¸°

ê¸°ìƒ: 09ì‹œ 20ë¶„

ë“±êµ: 11ì‹œ 00ë¶„

í•˜êµ: 17ì‹œ 00ë¶„

ì·¨ì¹¨: 25ì‹œ 00ë¶„ 

## âœ” To-do

- [x] CMU Databases Systems 9ê°•
- [x] CMU Databases Systems 10ê°•
- [x] CMU Databases Systems 11ê°• (Bloom Filter ì„¤ëª…ê¹Œì§€)
- [ ] ë§¤ìš° ë§›ìˆëŠ” ì €ë… ë¨¹ê¸°
- [ ] ì›”ìš”ì¼ ì •ê¸°ìš´ë™ íˆ¬í‘œ 18ì‹œ

## ğŸ’­ ì¼ê¸°

ì¼ìš”ì¼ì— ì¸í„´ì´ ë‚˜ì™”ë‹¤ê³  ë‹¤ë“¤ ë†€ë¼ì…¨ë‹¤. ì •ë§ë¡œ í‰ì¼ì— í•œ ê²Œ ì—†ì–´ì„œ ë‚˜ì˜¨ ê²ë‹ˆë‹¤ë§Œ... í•˜í•˜

ê²°êµ­ ì„¸ ê°œë°–ì— ëª» ë“¤ì—ˆë‹¤. ë§¤ì¼ë§¤ì¼ ì‹œê°„ì´ í—ˆë½í•˜ëŠ” ê°•ì˜ ê°œìˆ˜ë³´ë‹¤ í•œ ê°•ì”© ëœ ë“£ëŠ” ì¤‘ì´ë‹¤. ì–˜ê¸°ë„ ì¢€ í•˜ê³  ê²€ìƒ‰ë„ ì¢€ í•˜ê³  ì»¤í”¼ë„ ë§ˆì…”ì„œ ê·¸ëŸ° ë“¯. 

OKRì´ë¼ëŠ” ê±¸ ì“°ëŠ”ë° ì¢€ ë¶€ë„ëŸ¬ìš´ ê²°ê³¼ë‹¤. ë‚´ì¼ë„ ìš´ë™ ì „ê¹Œì§€ ê³µë¶€í•˜ë‹¤ê°€ ê°€ì•¼ì§€! 

## âœˆ Tomorrow

- [ ] CMU Databases Systems 11ê°• ë§ˆë¬´ë¦¬
- [ ] CMU Databases Systems 12ê°•
- [ ] CMU Databases Systems 13ê°•
- [ ] CMU Databases Systems 14ê°•
- [ ] ì¼ìš”ì¼ ì •ê¸°ìš´ë™ 14ì‹œ
- [ ] 
